{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{% block title %}GCinsumos - Cotizaciones{% endblock %}</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
<link href="{% static 'styles/globales.css' %}" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src='https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js'></script>

<style>
/* Dark mode para toda la web */
body.dark-mode { background-color: #121212; color: #e0e0e0; }
body.dark-mode .card { background-color: #1e1e1e; color: #e0e0e0; }
body.dark-mode .table { color: #e0e0e0; }
body.dark-mode .table-striped > tbody > tr:nth-of-type(odd) { background-color: #2a2a2a; }
body.dark-mode .btn { border-color: #444; color: #e0e0e0; }
body.dark-mode .alert { background-color: #333; color: #e0e0e0; border-color: #444; }
.navbar-dark-mode { background-color: #343a40 !important; }
.navbar-light-mode { background-color: #f8f9fa !important; }

/* Social Menu */
.social-menu { position: fixed; bottom: 50px; right: 30px; display: flex; flex-direction: column; gap: 10px; z-index: 999; }
.social-menu .toggle { background: #333; color: #fff; width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; }
.social-menu ul { list-style: none; margin: 0; padding: 0; display: none; flex-direction: column; gap: 10px; }
.social-menu ul li { width: 45px; height: 45px; background-color: var(--clr); border-radius: 50%; display: flex; align-items: center; justify-content: center; }
.social-menu ul li a { color: #fff; font-size: 18px; }
.social-menu.active ul { display: flex; }
</style>
</head>
<body class="{{ request.COOKIES.theme|default:'light' }}">

<!-- Navbar -->
    <nav id="navbar" class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
        <a class="navbar-brand d-flex align-items-center gap-2" href="{% url 'dashboard' %}">
        <img src="{% static 'images/logo.png' %}" alt="Logo" height="30">
        GCinsumos - Cotizaciones
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
        {% if user.is_authenticated %}
        <ul class="navbar-nav me-auto">
            <!-- Clientes -->
            <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">
                <i class="bi bi-people"></i> Clientes
            </a>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="{% url 'cliente_list' %}">Ver Clientes</a></li>
                <li><a class="dropdown-item" href="{% url 'cliente_create' %}">Nuevo Cliente</a></li>
            </ul>
            </li>
            <!-- Proveedores -->
            <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">
                <i class="bi bi-truck"></i> Proveedores
            </a>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="{% url 'proveedor_list' %}">Ver Proveedores</a></li>
                <li><a class="dropdown-item" href="{% url 'proveedor_create' %}">Nuevo Proveedor</a></li>
            </ul>
            </li>
            <!-- Productos -->
            <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">
                <i class="bi bi-box"></i> Productos
            </a>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="{% url 'producto_list' %}">Ver Productos</a></li>
                <li><a class="dropdown-item" href="{% url 'producto_create' %}">Nuevo Producto</a></li>
            </ul>
            </li>
            <!-- Cotizaciones -->
            <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">
                <i class="bi bi-file-text"></i> Cotizaciones
            </a>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="{% url 'cotizacion_list' %}">Ver Cotizaciones</a></li>
                <li><a class="dropdown-item" href="{% url 'cotizacion_create' %}">Nueva Cotización</a></li>
            </ul>
            </li>
        </ul>

        <ul class="navbar-nav">
            {% if user.is_staff %}
            <li class="nav-item">
            <a class="nav-link" href="{% url 'admin:index' %}">
                <i class="bi bi-speedometer2"></i> Admin
            </a>
            </li>
            {% endif %}
            <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">
                <i class="bi bi-person-circle"></i> {{ user.get_full_name|default:user.username }}
            </a>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="{% url 'logout' %}">Cerrar Sesión</a></li>
            </ul>
            </li>
            <li class="nav-item">
            <button id="darkModeToggle" class="btn btn-outline-light ms-2"><i class="bi bi-moon"></i></button>
            </li>
        </ul>
        {% else %}
        <ul class="navbar-nav ms-auto">
            {% if 'login' in urls %}
            <li class="nav-item"><a class="nav-link" href="{% url 'login' %}">Iniciar Sesión</a></li>
            {% endif %}
            {% if 'register' in urls %}
            <li class="nav-item"><a class="nav-link" href="{% url 'register' %}">Registrarse</a></li>
            {% endif %}
        </ul>
        {% endif %}
        </div>
    </div>
    </nav>

    <!-- Mensajes -->
    {% if messages %}
    <div class="container mt-3">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    {% endfor %}
    </div>
    {% endif %}

    <!-- Contenido principal -->
    <div class="container mt-4">{% block content %}{% endblock %}</div>

    <!-- Social Menu -->
    <div class="social-menu">
    <div class="toggle"><ion-icon name="share-social"></ion-icon></div>
    <ul>
        <li style="--i: 0; --clr: #1877f2"><a href="#"><i class="fab fa-facebook-f"></i></a></li>
        <li style="--i: 1; --clr: #25d366"><a href="#"><i class="fab fa-whatsapp"></i></a></li>
        <li style="--i: 2; --clr: #1b1e21"><a href="#"><i class="fab fa-x-twitter"></i></a></li>
        <li style="--i: 3; --clr: #ff5733"><a href="#"><i class="fab fa-reddit-alien"></i></a></li>
        <li style="--i: 4; --clr: #0a66c2"><a href="#"><i class="fab fa-linkedin-in"></i></a></li>
        <li style="--i: 5; --clr: #c32aa3"><a href="#"><i class="fab fa-instagram"></i></a></li>
        <li style="--i: 6; --clr: #1b1e21"><a href="#"><i class="fab fa-github"></i></a></li>
        <li style="--i: 7; --clr: #ff0000"><a href="#"><i class="fab fa-youtube"></i></a></li>
    </ul>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
    // Dark/Light Mode
    const darkToggle = document.getElementById('darkModeToggle');
    darkToggle.addEventListener('click', () => {
        document.body.classList.toggle('dark-mode');
        // Cambiar ícono
        const icon = darkToggle.querySelector('i');
        icon.classList.toggle('bi-moon');
        icon.classList.toggle('bi-sun');
    });

    // Social Menu
    const socialToggle = document.querySelector('.social-menu .toggle');
    const socialMenu = document.querySelector('.social-menu');
    socialToggle.addEventListener('click', () => {
        socialMenu.classList.toggle('active');
    });
</script>

{% block extra_js %}{% endblock %}
</body>
</html>
